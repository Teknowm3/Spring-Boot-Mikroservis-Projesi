sequenceDiagram
    autonumber
    participant U as ðŸ‘¤ User
    participant FE as ðŸŒ Frontend
    participant NG as ðŸ“¡ Nginx
    participant GW as ðŸšª API Gateway
    participant RL as â±ï¸ Rate Limiter
    participant AU as ðŸ” Auth Service
    participant DB as ðŸ—„ï¸ MySQL
    participant JWT as ðŸŽ« JWT Util

    U->>FE: Enter username & password
    FE->>FE: Validate form inputs
    FE->>NG: POST /api/auth/login
    NG->>GW: Forward to Gateway
    
    GW->>RL: Check rate limit
    alt Rate limit exceeded
        RL-->>GW: 429 Too Many Requests
        GW-->>FE: Error response
        FE-->>U: "Ã‡ok fazla deneme, bekleyin"
    else Rate limit OK
        RL-->>GW: Allow
        GW->>AU: Forward login request
        AU->>DB: SELECT * FROM users WHERE username=?
        
        alt User not found
            DB-->>AU: Empty result
            AU-->>GW: 401 Unauthorized
            GW-->>FE: Error response
            FE-->>U: "KullanÄ±cÄ± bulunamadÄ±"
        else User found
            DB-->>AU: User record
            AU->>AU: BCrypt.matches(password, hash)
            
            alt Password mismatch
                AU-->>GW: 401 Unauthorized
                GW-->>FE: Error response
                FE-->>U: "Åžifre hatalÄ±"
            else Password valid
                AU->>JWT: generateToken(user)
                JWT-->>AU: JWT token string
                AU-->>GW: AuthResponse{token, role}
                GW-->>FE: 200 OK + token
                FE->>FE: localStorage.setItem('user', token)
                FE-->>U: Redirect to Dashboard
            end
        end
    end
